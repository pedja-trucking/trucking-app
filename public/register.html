<!doctype html>
<html>
<head><meta charset="utf-8"><title>Register</title></head>
<body>
  <h2>Register</h2>
  <input id="email" placeholder="email"/><br/>
  <input id="username" placeholder="username (optional)"/><br/>
  <input id="pass" type="password" placeholder="password"/><br/>
  <button id="reg">Register</button>
  <div id="msg"></div>
<script>
document.getElementById('reg').onclick = async () => {
  const email = document.getElementById('email').value;
  const username = document.getElementById('username').value;
  const password = document.getElementById('pass').value;
  const r = await fetch('/api/register', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({ email, username, password }),
    credentials: 'include'
  });
  const j = await r.json();
  document.getElementById('msg').innerText = JSON.stringify(j);
  if (j.ok) window.location = '/login.html';
};
</script>
</body>
</html>
